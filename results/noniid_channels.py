__author__ = 'yihanjiang'

# AWGN-EG 0.8 p_gg, 0.8 p_bb


turbo757_ge_awgn_snr =  [-1.5, -1.0, -0.5, 0.0, 0.5, 1.0, 1.5, 2.0]
turbo757_ge_awgn_ber = [0.163, 0.120919, 0.076027, 0.039762, 0.015186, 0.004697, 0.001143, 0.000375]
turbo757_ge_awgn_bler = [0.9685, 0.8674999999999999, 0.6720999999999999, 0.4265, 0.2027, 0.08040000000000003, 0.02749999999999997, 0.012199999999999989]


turbolte_ge_awgn_ber = [0.175367, 0.132255, 0.083961, 0.042518, 0.014841, 0.004388, 0.000974, 0.000151]
turbolte_ge_awgn_bler = [0.9601999999999999, 0.8581, 0.6333, 0.36829999999999996, 0.15759999999999996, 0.05669999999999997, 0.019299999999999984, 0.005600000000000049]

dta_cont_awgn_trained_ge_awgn_ber = [0.04588819295167923, 0.015976598486304283, 0.004368799738585949, 0.000986799830570817,
                                     0.0002549999626353383, 7.499998901039362e-05, 3.039999137399718e-05, 9.79999913397478e-06]




dta_cont_geawgn_trained_ge_awgn_ber_0dB = [0.03834819421172142, 0.013421999290585518, 0.0037079998292028904, 0.0008731998386792839,
                                           0.000269699958153069, 9.900004079099745e-05, 3.8800000766059384e-05, 1.2699998478638008e-05]
dta_cont_geawgn_trained_ge_awgn_ber_2dB = [0.07875409722328186, 0.034837301820516586, 0.011215799488127232, 0.0027912999503314495,
                                           0.0005157000268809497, 0.0001024000157485716, 3.680001100292429e-05, 9.99999883788405e-06]
dta_cont_geawgn_trained_ge_awgn_ber = [0.03834819421172142, 0.013421999290585518, 0.0037079998292028904, 0.0008731998386792839,
                                           0.000269699958153069, 9.900004079099745e-05, 3.680001100292429e-05, 9.99999883788405e-06]


dta_2quant_awgn_trained_ge_awgn_ber =[0.03432999923825264, 0.014941999688744545, 0.006432000081986189, 0.002623999956995249, 0.0013020000187680125, 0.000615999975707382, 0.00027799999224953353, 0.00013299999409355223]



dta_2quant_geawgn_trained_ge_awgn_ber =  [0.03272319585084915, 0.014719194732606411, 0.0063557978719472885, 0.0026169996708631516, 0.0012316000647842884, 0.000552999961655587, 0.0002929999609477818, 0.00013180002861190587]


# BSC-EG 0.8 p_gg, 0.8 p_bb
ge_snrs =    [0.2, 0.30000000000000004, 0.4, 0.5, 0.6000000000000001, 0.7000000000000002, 0.8]
dta_bsc_trained_ge_ber = [0.07711600512266159, 0.03317800164222717, 0.010734000243246555, 0.0037079998292028904, 0.0012180000776425004, 0.0003319999959785491, 7.000000186963007e-05]
dta_bsc_trained_ge_bler =  [0.8564, 0.6412000000000001, 0.3736, 0.19059999999999996, 0.0802, 0.026000000000000002, 0.0062]

dta_bsc_ge_trained_ge_ber = [0.07639100402593613, 0.032010000199079514, 0.011845000088214874, 0.0038169999606907368, 0.0012029999634250998, 0.0003029999788850546, 5.499999967170879e-05]

turbo757_ge_ber = [0.075122, 0.029972, 0.007529, 0.001249, 0.000224, 4.3e-05, 1e-05]
turbo757_ge_bler =  [0.6648000000000001, 0.3548, 0.123, 0.03300000000000003, 0.008399999999999963, 0.0026000000000000467, 0.0004999999999999449]

turbolte_ge_ber = [0.077365, 0.029164, 0.007009, 0.000875, 7.9e-05, 2.78e-05, 5.4e-06]
turbolte_ge_bler = [0.6018, 0.29190000000000005, 0.08950000000000002, 0.02200000000000002, 0.005800000000000027, 0.0012999999999999678, 0.0007000000000000339]

import matplotlib.pylab as plt

plt.figure(1)
plt.yscale('log')
plt.title('Non-IID Gilbert-Elliott BSC Channel BER')

p1, = plt.plot(ge_snrs,dta_bsc_trained_ge_ber, label = 'DTA trained on BSC')


p2, = plt.plot(ge_snrs,turbo757_ge_ber, '-x', label = 'Turbo-757')
p3, = plt.plot(ge_snrs,turbolte_ge_ber, '-+', label = 'Turbo-LTE')

p4, = plt.plot(ge_snrs,dta_bsc_ge_trained_ge_ber, label = 'DTA trained on GE')

plt.legend(handles = [p1, p2, p3, p4])


plt.grid()


deepturbo_geawgn = [0.052478592842817307, 0.026815198361873627, 0.011546002700924873, 0.004046800546348095, 0.0012471999507397413, 0.000340400030836463, 0.00010139998630620539, 3.0199993489077315e-05, 1.2999998943996616e-05, 3.400000196052133e-06, 3.9999997625272954e-07, 5.999999643790943e-07]
plt.figure(2)
plt.yscale('log')
plt.title('Non-iid Markovian AWGN Channel')

#p1, = plt.plot(turbo757_ge_awgn_snr,dta_cont_awgn_trained_ge_awgn_ber, label = 'DTA-continuous trained on AWGN')


p2, = plt.plot(turbo757_ge_awgn_snr,turbo757_ge_awgn_ber, '-x', label = 'Turbo')
p3, = plt.plot(turbo757_ge_awgn_snr,deepturbo_geawgn[:8], '-+', label = 'DeepTurbo')
#p4, = plt.plot(turbo757_ge_awgn_snr,dta_2quant_awgn_trained_ge_awgn_ber, label = 'DTA-2quantize trained on AWGN')

p5, = plt.plot(turbo757_ge_awgn_snr,dta_cont_geawgn_trained_ge_awgn_ber, '-.',label = 'TurboAE-continuous')
p6, = plt.plot(turbo757_ge_awgn_snr,dta_2quant_geawgn_trained_ge_awgn_ber, '-o',label = 'TurboAE-binary')

plt.legend(handles = [p2, p3,  p5, p6])


plt.grid()

plt.show()