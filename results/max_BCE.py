__author__ = 'yihanjiang'

snrs = [-1.5, -1.0, -0.5, 0.0, 0.5, 1.0, 1.5, 2.0, 2.5, 3.0, 3.5, 4.0]


# combined result
dta_cont_cnn2enc_cnn5dec_combined_ber = [0.047043804079294205, 0.025237491354346275,  0.010004100389778614, 0.0030416203662753105,
                                        0.0007227200549095869,0.00019923502986785024, 6.059997758711688e-05, 1.9379973309696652e-05,
                                        6.014996415615315e-06, 1.7300009176324238e-06, 4.1999996369668224e-07, 9.00000216574881e-08]

dta_q2_cnn2enc_cnn5dec_combined_ber = [0.08075735718011856, 0.03741989657282829, 0.01354303676635027, 0.003595138667151332,
                                        0.0008670896058902144, 0.0002506198943592608, 8.751997006079182e-05, 2.9970024115755223e-05,
                                       1.1290004295005929e-05, 3.2000019463244826e-06, 1.070000166691898e-06, 3.000000106112566e-07]



dta_cont_cnn2enc_cnn5dec_combined_bler =[0.641712999999999, 0.40324099999999996, 0.2007309999999997, 0.08383600000000012,
                                         0.03029899999999994, 0.010856499999999944, 0.003988999999999977, 0.0013614999999999838,
                                        0.00043950000000000033, 0.0001255000000000001, 3.2500000000000024e-05, 8.000000000000003e-06]

dta_q2_cnn2enc_cnn5dec_combined_bler = [0.6662359999999999, 0.4307619999999997, 0.22268199999999988, 0.096248,
                                                         0.03869800000000008, 0.015362999999999991, 0.006246999999999979, 0.0023629999999999875,
                                                         0.0008620000000000007, 0.0002710000000000002, 0.00010500000000000009, 2.900000000000002e-05]


dta_cont_cnn2enc_cnn5dec_enctrain2_dectrainneg15_2_ber = [0.10074236243963242, 0.04645926132798195, 0.016037607565522194, 0.004073908552527428,
                                                          0.0008630399242974818, 0.00019923502986785024, 6.059997758711688e-05, 1.9379973309696652e-05,
                                                          6.014996415615315e-06, 1.7300009176324238e-06, 4.1999996369668224e-07, 9.00000216574881e-08]


dta_cont_cnn2enc_cnn5dec_enctrain2_dectrainneg15_2_bler =[0.6667735000000005, 0.4258410000000012, 0.21239300000000005, 0.08461900000000021,
                                                          0.03029899999999994, 0.010856499999999944, 0.003988999999999977, 0.0013614999999999838,
                                                          0.00043950000000000033, 0.0001255000000000001, 3.2500000000000024e-05, 8.000000000000003e-06]



# max BCE loss
maxbce_cont_cnn2enc_cnn5dec_enctrain2_dectrainneg15_2_ber = [0.10938149690628052, 0.04980907216668129, 0.016753345727920532, 0.004221279174089432,
                                                             0.0008766601094976068, 0.00021062002633698285, 6.0040019889129326e-05, 1.9460005205473863e-05,
                                                             5.919999239267781e-06, 1.99999976757681e-06, 7.000001005508238e-07, 1.5999999902760464e-07]

maxbce_cont_cnn2enc_cnn5dec_enctrain2_dectrainneg15_2_bler =  [0.6276840000000005, 0.390272, 0.19055799999999995, 0.07601999999999998,
                                                               0.02718600000000001,0.009849999999999986, 0.0036219999999999907, 0.0012300000000000008, 0.0003940000000000003,
                                                               0.0001240000000000001, 4.0000000000000024e-05, 8e-06]

maxbce_q2_cnn2enc_cnn5dec_enctrain2_dectrainneg15_2_ber =[0.1230318620800972, 0.0553620308637619, 0.01857101358473301, 0.004673060495406389, 0.0010388403898105025, 0.0002666599757503718, 8.548000187147409e-05, 3.128002936136909e-05, 1.2160016922280192e-05, 4.099999387108255e-06, 1.3799998441754724e-06, 3.400000139208714e-07]
maxbce_q2_cnn2enc_cnn5dec_enctrain2_dectrainneg15_2_bler = [0.6380999999999998, 0.40592800000000007, 0.20862000000000008, 0.08984399999999992, 0.036194, 0.014667999999999992, 0.005777999999999984, 0.0023219999999999977, 0.0009400000000000007, 0.00032000000000000024, 0.00010600000000000008, 3.2000000000000005e-05]


import matplotlib.pylab as plt

plt.figure(1)
plt.subplot(121)
plt.yscale('log')
plt.xlabel('SNR')
plt.ylabel('BER')


h1, = plt.plot(snrs, dta_cont_cnn2enc_cnn5dec_combined_ber, '-+', label = 'DTA-continuous CNN-enc CNN-dec')
h2, = plt.plot(snrs, dta_q2_cnn2enc_cnn5dec_combined_ber, '-.', label = 'DTA-binary CNN-enc CNN-dec')

t1, = plt.plot(snrs, maxbce_cont_cnn2enc_cnn5dec_enctrain2_dectrainneg15_2_ber, '-x', label = 'maxBCE-continue CNN-enc CNN-dec')
t2, = plt.plot(snrs, maxbce_q2_cnn2enc_cnn5dec_enctrain2_dectrainneg15_2_ber, '-o', label = 'maxBCE-binary CNN-enc CNN-dec')

plt.legend(handles =[h1,h2, t1, t2])
plt.grid()

plt.subplot(122)
plt.yscale('log')
plt.xlabel('SNR')
plt.ylabel('BLER')


h1, = plt.plot(snrs, dta_cont_cnn2enc_cnn5dec_combined_bler, '-+', label = 'DTA-continuous CNN-enc CNN-dec')
h2, = plt.plot(snrs, dta_q2_cnn2enc_cnn5dec_combined_bler, '-.', label = 'DTA-binary CNN-enc CNN-dec')

t1, = plt.plot(snrs, maxbce_cont_cnn2enc_cnn5dec_enctrain2_dectrainneg15_2_bler, '-x', label = 'maxBCE-continue CNN-enc CNN-dec')
t2, = plt.plot(snrs, maxbce_q2_cnn2enc_cnn5dec_enctrain2_dectrainneg15_2_bler, '-o', label = 'maxBCE-binary CNN-enc CNN-dec')

plt.legend(handles =[h1,h2, t1, t2])
plt.grid()

plt.show()