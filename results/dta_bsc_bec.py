__author__ = 'yihanjiang'

# try to implement BSC and BEC channels
# Turbo is good for AWGN, but bad for BSC/BEC.


bec_snr =  [0.4, 0.45, 0.5, 0.55, 0.6000000000000001, 0.65, 0.7000000000000001, 0.75, 0.8]
turbo757_i6_bec_ber = [6e-05, 0.00012, 0.00042, 0.00379, 0.05033, 0.17643, 0.2958, 0.35122, 0.39425]
turbolte_i6_bec_ber = [2.2e-05, 4.5e-05, 0.000218, 0.00376, 0.060732, 0.212728, 0.311173, 0.358292, 0.392773]

turbo757_i2_bec_ber = [3.4e-05, 0.000135, 0.001306, 0.014318, 0.083441, 0.205357, 0.298153, 0.353525, 0.390929]
turbolte_i2_bec_ber =  [2e-05, 6.1e-05, 0.000768, 0.013937, 0.096412, 0.229403, 0.31341, 0.359202, 0.392553]


bsc_snr = [0.0, 0.01, 0.02, 0.030000000000000006, 0.04, 0.05, 0.06000000000000001, 0.07, 0.08, 0.09, 0.1, 0.11000000000000001, 0.12000000000000002, 0.13, 0.14, 0.15, 0.16, 0.17, 0.18, 0.19, 0.2]

turbo757_i6_bsc_ber =[0.0, 0.0, 5e-07, 1.7e-06, 7.3e-06, 1.57e-05, 4.49e-05, 9.21e-05, 0.0001962, 0.0004786, 0.0012824, 0.0031613, 0.0077016, 0.0163846, 0.0305347, 0.0513911, 0.077135, 0.1061192, 0.1343882, 0.162046, 0.1861339]

turbolte_i6_bsc_ber =   [0.0, 0.0, 1e-06, 1e-06, 1e-05, 1.3e-05, 1.8e-05, 4.1e-05, 8.8e-05, 0.000275, 0.000889, 0.002265, 0.006737, 0.015115, 0.031307, 0.054536, 0.081615, 0.113645, 0.14503, 0.171172, 0.195098]

turbo757_i2_bsc_ber =  [0.0, 0.0, 0.0, 3e-06, 1e-05, 1.8e-05, 8.9e-05, 0.000151, 0.000501, 0.001203, 0.003075, 0.007014, 0.01424, 0.026184, 0.043963, 0.065884, 0.090144, 0.118199, 0.144265, 0.167745, 0.191282]
turbolte_i2_bsc_ber = [0.0, 0.0, 1e-06, 1e-06, 4e-06, 8e-06, 5.2e-05, 0.000114, 0.000234, 0.000795, 0.002171, 0.005599, 0.013426, 0.024784, 0.0444, 0.069479, 0.097592, 0.12572, 0.154047, 0.17886, 0.202501]




dta_bec_snr =  [0.4, 0.45, 0.5, 0.55, 0.6000000000000001, 0.65, 0.7000000000000001, 0.75, 0.8]
dta_bec_q2_awgn_trained_ber = [3.819999983534217e-05, 0.00027059996500611305, 0.004978800192475319, 0.0507860891520977, 0.1773233711719513, 0.3015240430831909, 0.37405702471733093, 0.41631099581718445, 0.44434165954589844]
dta_bec_q2_awgn_trained_bler = [0.003160000000000002, 0.013359999999999992, 0.09460000000000003, 0.49528000000000005, 0.9208100000000005, 0.9983299999999997, 1.0, 1.0, 1.0]

dta_bec_q2_trained_ber = [4.4000007619615644e-05, 0.00016301999858114868, 0.0013889196561649442, 0.018826741725206375, 0.11027201265096664, 0.2623770534992218, 0.3657348155975342, 0.41705387830734253, 0.44749873876571655]
dta_bec_q2_trained_bler = [0.0035679999999999905, 0.011595999999999995, 0.046912000000000044, 0.24744999999999995, 0.729734, 0.9795020000000001, 0.9998400000000013, 1.0, 1.0]



dta_bsc_snr =    [0.0, 0.02, 0.04, 0.06, 0.08, 0.1, 0.12, 0.14, 0.16, 0.18, 0.2]

dta_bsc_q2_awgn_trained_ber = [0.0, 3.000000106112566e-07, 6.300001587078441e-06, 4.982002792530693e-05, 0.00026404004893265665, 0.001371199730783701, 0.008037557825446129, 0.03531692922115326, 0.09867611527442932, 0.18629008531570435, 0.26903513073921204]
dta_bsc_q2_awgn_trained_bler = [0.0, 2.4000000000000007e-05, 0.0004840000000000004, 0.003775999999999988, 0.01742399999999997, 0.06258999999999999, 0.19129200000000002, 0.4487340000000001, 0.7406120000000004, 0.9215760000000005, 0.9853600000000003]


dta_bsc_q2_awgn_trained_ber = [0.0, 3.250000020216248e-07, 7.40000086807413e-06, 5.307502578943968e-05, 0.00026147504104301333, 0.0013692997163161635, 0.00782135222107172, 0.034666623920202255, 0.09782780706882477, 0.18508049845695496, 0.26788291335105896]

dta_bsc_q2_trained_ber = [0.0, 2.2000003241373634e-07, 5.499999588209903e-06, 5.1040013204328716e-05, 0.00027118000434711576, 0.0013811398530378938, 0.008030002005398273, 0.03581925481557846, 0.09981071949005127, 0.18763332068920135, 0.270062655210495]

import matplotlib.pylab as plt

plt.figure(1)
plt.subplot(121)
plt.title('BEC Channel')
plt.yscale('log')
plt.xlabel('Erasure Rate')
plt.ylabel('BER')

p1, = plt.plot(bec_snr, turbo757_i6_bec_ber, label = 'Turbo')
#p2, = plt.plot(bec_snr, turbolte_i6_bec_ber, label = 'Turbo LTE')
p3, = plt.plot(dta_bec_snr, dta_bec_q2_awgn_trained_ber,'-x', label = 'TurboAE-binary AWGN trained')
p4, = plt.plot(dta_bec_snr, dta_bec_q2_trained_ber,'->', label = 'TurboAE-binary BEC trained')




plt.legend(handles = [p1,  p3, p4 ])
plt.grid()


plt.subplot(122)
plt.title('BSC Channel')
plt.yscale('log')
plt.xlabel('Flip Rate')
plt.ylabel('BER')

p1, = plt.plot(bsc_snr, turbo757_i6_bsc_ber, label = 'Turbo')
#p2, = plt.plot(bsc_snr, turbolte_i6_bsc_ber, label = 'Turbo LTE')
p3, = plt.plot(dta_bsc_snr, dta_bsc_q2_awgn_trained_ber, '-x',label = 'TurboAE-binary AWGN trained')
p4, = plt.plot(dta_bsc_snr, dta_bsc_q2_trained_ber, '->',label = 'TurboAE-binary BSC trained')




plt.legend(handles = [p1,  p3, p4])
plt.grid()


plt.show()









